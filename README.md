# note4
&ensp;&ensp;&ensp;&ensp;总线型：所有设备串联在公共的总线，只能同时传递一个信号，链接的设备的越多，性能越来越差
当其中两个设备传输数据，别的设备也可以收到，安全性差，数据容易泄露。同轴电缆，两端有设备把信号终结掉，终结器就是电阻
统互联国际标准化连接（ISO) 
OSI定义了开放的标准，把网络切分成了七个部分，管理方便
应用层    应用的程序的界面，浏览器  应用程序  底层的协议不同
表示层  数据的表达，把二进制变成人们所认识的数据  ascii码  utf-8   加密，压缩 

会话层  同一端口，不同终端，互不干扰，何时建立连接，建立多久（规定时间）
传输层  segent  段   终端对终端的通信  先测试包实验
网络层  数据的逻辑地址确定（package) 包：ip地址  路由，路径的问题
数据链路层   把二进制做了格式化的规定，变成帧（frame)，把二进制的前多少位表示原地址，目标地址，称为物理地址（mac)。错误检查   链路
物理层  实现电气的各种特性，频段，网线，电压（规范），把信息变成二进制单位（bit)位
通讯的过程是封装和解封装，解封装是下层是为上层提供服务，网络层有很多协议，下层必须标记各种协议，否则上层无法识别，每个数据包文里都有各种上层协议的标识
  应用层（application)    表示层（persention)  会话层（session)   传输层（transport)    网络层（network)     数据链路层（data link)   物理层（physical)
  直连线 T568B  线序是橙白  橙  绿白  蓝   蓝白   绿   棕白  棕这种程度的排列可以最大抵消电磁干扰
如果两台电脑直连，应该把线对掉，1，2是发送，3，6是接收    两边线序一样叫直连线
交叉线T568A   一个接口以12345678，另一接口是36145278   绿白  绿  橙白  蓝 蓝白   橙  棕白  棕
两端线序不一样叫交叉线
以太网工作在数据链路层，规定包文的帧结构
有线以太网双绞线    无线是wifl   国际上的编号802.11        n4  ac5  ax6
马斯洛理论把人类的需求分成了几个阶段：电源（power)   wifi  生理  安全  社会  尊重  自我实现
施乐  图像界面     Intel   cpu     DEC   1982第一个以太网     802.3官方标准ieee国际电子电器协会
早期的以太网就一种协议   novell 公司      ipx/spx   802.3(淘汰）没有上层协议的类型
以太网二代  把没有的上层协议定义了上层协议的类型（最短72个字节最长1526）
  fcs是校验位  去掉开头和结尾，用户看到有用的信息是60-1514，也是抓包软件要抓的部分
上图的6表示物理地址 6个字节48位是国际组织规定用的编号，最后的24的位是自己制定（每一个网卡是唯一的） 前一半是mac  媒体访问控制   二的48次方      ip  a看mac地址
交换机的工作原理：交换机的内部有内存一样的设备，它会把第一次发过来数据的主机源地址记住，然后把报文发送其他所有端口，当其中另一台主机回应经过它时，它也会记录另一台的主机的源地址，等下次再发送数据，经过读取报文，看到了目标地址，会直接把数据发给主机，不会再发给所有端口。多路信号经过交换机是互补影响的。一个口代表一个冲突域，
镜像端口，得配置交换机
如果把交换机的内存表占满了，交换机就会把收到主机的数据以广播形式转发。
交换机不能隔断广播域，只能隔断冲突域
帧头是固定的22个字节
TCP前20个字节是固定的
前2个字节放源端口号区分上层的应用程序（端口号相当于应用程序的地址）2的16次方（65536）
Client客户端/server        B(broswer)浏览器/s   http://是B/s结构
服务器端口号：http用的TCP80    https tcp  443          ssh用的22      ftp   21      QQ:udp  8000  端口号有国际组织分配的，dhcp 67 68    snmp 161      mysql   3306     oracle  1521   kerberos(加密）   88 sqlserver  1433         smtp邮件传输  25    pop3   110        imap  143(0-1023)管理员可用端口号       （1024-49151）普通用户的端口号      ss -nt (可以查到应用程序的端口号)        /etc/services    文件记录了应用程序的端口号
客户端    49152-65535
源端口自己的端口（随机生成）
目的端口：服务器端口是固定
ARP协议实现计算机连接，
当一台计算机 第一次连接另一台计算机，会发一个以ARP广播形式的请求报文，每台电脑都有一个缓存区，记录了mac和IP地址的对应关系
rap -n可以查看mac地址和IP的对应关系
ARP广播之后才是ICMP协议
免费ARP机器在启动时会以广播形式询问，自己的这个IP是否有设备再用
当A向B发报文时，因为经过路由，ARP无法用广播形式找到B，只能先找到通过B的路由，于是把它的MAC地址暂时当成B，于是报文可以达到路由器，这个时候，包文的源iP不变，但MAC地址变成了路由的mac地址，然后接着利用ARP的广播形式里找寻下个可以靠近B 的路由，当成自己的mac地址，当找到B所在的网段，报文所带的Bip对上之后，才会进行ICMP协议
第一步，先经过网卡判断是否在一个网段，应用程序指定需要TCP的连接，需要通过tcp建立会化，当发现不在一个网段，数据的报文的IP地址知道，但MAC地址不知道，利用ARP广播来寻找MAC地址，但是机器上的mac缓存表示空的，于是在报文的目标mac地址是空的（填写广播地址），经过广播发出去之后，目标地址收到广播，发现ip找的是自己，于是会把报文里的源地址和mac地址写到自己的缓存表里，当目标地址得到请求报文之后，会发送回应包，写上自己的源地址，目标地址，当应用程序收到回应包之后，会把目标的地址的IP和mac地址写到自己的MAC缓存表里，这样就可以把数据报文写全了，写上同步位，就可以发请求报文，建立第一次握手了，报文经过物理层，网络层,当目标地址收到之后，会发一个回应报文，ACK确定，SYN，加上IP地址,封装MAC地址，当源地址收到之后，解封装得到标记位，源地址在发ACK确定报文，传过去，消息一发出去，就进入里连接状态，开始发数据，应用程序加上TCP的头部，IP地址的头部，加上MAC地址，传输
